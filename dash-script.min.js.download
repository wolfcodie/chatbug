function fillSubscribeFields(n){var t={auth:arrayBufferToBase64(n.getKey("auth")),p256dh:arrayBufferToBase64(n.getKey("p256dh")),endpoint:n.endpoint};$.post(_subscribeUrl,t)}function arrayBufferToBase64(n){for(var i="",r=new Uint8Array(n),u=r.byteLength,t=0;t<u;t++)i+=String.fromCharCode(r[t]);return window.btoa(i)}function checkURLParameter(n){const t=new URLSearchParams(window.location.search);t.has(n)&&$(".open-chat").trigger("click")}$(".open-chat").click(function(){window.location.pathname!==_chatUrl&&openDataInSideBar("#chat-sidebar",_chatUrl,!0,"l")});var pageWidth=$(window).width();pageWidth<=480?($(".minthr-nav-btn-add").click(function(){$(".mobile-add-demande").toggleClass("open")}),$(".mobile-add-demande-close").click(function(){$(".mobile-add-demande").removeClass("open")})):($(".new-btn").click(function(n){n.preventDefault();$(this).parent().find(".minthr-notification-dropdown").toggleClass("active")}),$(".close-dropdown").click(function(){$(this).parent().closest(".minthr-notification-dropdown").toggleClass("active")}),$(".minthr-notification-dropdown a").click(function(){$(this).parent().closest(".minthr-notification-dropdown").toggleClass("active")}));$.get(_receivedMsgUrl).done(function(n){n>0&&window.location.pathname!==_chatUrl?$(".minthr-nav-btn-message button").addClass("active"):$(".minthr-nav-btn-message button").removeClass("active")});"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(n=>{n.pushManager.getSubscription().then(function(t){t===null?n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_publicKey}).then(function(n){fillSubscribeFields(n)}).catch(function(n){console.error("Unable to subscribe to push",n)}):fillSubscribeFields(t)})}).catch(n=>{console.error("Service Worker registration failed:",n)});$(function(){checkURLParameter("chat");loguser()});